'use client'
import * as React from 'react'
import type { NextPage } from 'next'
import { useRouter } from 'next/router'
import Link from 'next/link'

import { EmploymentFormsHeader } from '@/components/layout'
import { useInvoiceRef } from '@/features/invoice'
import { usePostEmail } from '@/features/email'
import { useForm, SubmitHandler } from 'react-hook-form'
import { useNotificationModalControl } from '@/hooks'
import { NotificationModalOtp } from '@/components/elements'

type FormValues = {
  email: string
}

const SavedCards: NextPage = () => {
  const router = useRouter()
  const { savedcards } = router.query

  const {
    message: successModalMessage,
    isModalOpen: isSuccessModalOpen,
    closeModal: closeSuccessModal,
    openModal: openSuccessModal,
  } = useNotificationModalControl()

  const { data: viewInvoiceData } = useInvoiceRef(savedcards as string)
  const { mutate: postEmail } = usePostEmail()

  const { handleSubmit, reset } = useForm<FormValues>({})

  const onSubmit: SubmitHandler<FormValues> = (data) => {
    const updatedData = {
      ...data,
      email: viewInvoiceData?.client_email,
    }

    postEmail(updatedData, {
      onSuccess: ({ data: getMessage }) => {
        openSuccessModal(getMessage.message)
        reset()
      },
    })
  }

  return (
    <>
      <NotificationModalOtp
        headingText={successModalMessage}
        label={successModalMessage}
        type="success"
        allowDismiss
        closeModal={closeSuccessModal}
        isModalOpen={isSuccessModalOpen}
        invoiceReferenece={savedcards as string}
      />

      <div className="h-full w-full overflow-hidden bg-[#4d00ac]">
        <div className="mx-auto h-screen w-full max-w-[1000px] flex-shrink-0 bg-[#ffffff]">
          <EmploymentFormsHeader />
          <div className="h-full xl:flex xl:justify-evenly">
            <div className="mx-auto w-full max-w-[1000px] flex-shrink-0">
              <div className="mx-auto  w-full  bg-[#F9FBFF]">
                {' '}
                <div className="">
                  <div className="mt-4 flex h-full max-h-[800px] w-full flex-col items-start justify-start px-4">
                    <h1 className=" mt-6 font-sans text-[18px] font-semibold text-black md:mb-6 md:text-[33px]">
                      Choose payment method
                    </h1>

                    <form className="w-full" onSubmit={handleSubmit(onSubmit)}>
                      <button className="mt-4 flex w-full items-center justify-between px-4">
                        <svg
                          width="40"
                          height="32"
                          viewBox="0 0 40 32"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <rect width="40" height="32" rx="4" fill="#FAE5F9" />
                          <path
                            d="M31.0925 16.5701V22.2938C31.0924 22.528 31.0461 22.7598 30.9563 22.9761C30.8666 23.1923 30.7351 23.3888 30.5694 23.5542C30.4037 23.7197 30.207 23.8509 29.9906 23.9403C29.7742 24.0297 29.5423 24.0756 29.3081 24.0754H13.6418C13.4077 24.0756 13.1758 24.0297 12.9594 23.9403C12.743 23.8509 12.5463 23.7197 12.3806 23.5542C12.2149 23.3888 12.0834 23.1923 11.9936 22.9761C11.9039 22.7598 11.8576 22.528 11.8574 22.2938V16.5701H31.0925ZM28.9148 20.441C28.9153 20.1458 28.8243 19.8576 28.6543 19.6162C28.4843 19.3748 28.2437 19.192 27.9656 19.0929C27.6874 18.9938 27.3854 18.9834 27.1011 19.063C26.8168 19.1426 26.5641 19.3083 26.3778 19.5374C26.1914 19.3092 25.9389 19.1443 25.6551 19.0653C25.3712 18.9862 25.0698 18.9969 24.7923 19.0959C24.5147 19.1948 24.2746 19.3772 24.1048 19.6181C23.935 19.8589 23.8438 20.1463 23.8438 20.441C23.8438 20.7357 23.935 21.0231 24.1048 21.264C24.2746 21.5048 24.5147 21.6872 24.7923 21.7862C25.0698 21.8851 25.3712 21.8958 25.6551 21.8168C25.9389 21.7377 26.1914 21.5728 26.3778 21.3446C26.5645 21.5728 26.8172 21.7377 27.1012 21.8167C27.3852 21.8958 27.6868 21.8851 27.9645 21.7862C28.2422 21.6873 28.4826 21.5049 28.6527 21.2641C28.8228 21.0233 28.9144 20.7358 28.9148 20.441Z"
                            fill="#E88CE2"
                          />
                          <path
                            d="M31.0925 14.0046V16.5701H12.017H11.8574V14.0046H12.017H31.0925Z"
                            fill="#EFAFEB"
                          />
                          <path
                            d="M31.0925 12.6792V14.0047H11.8574V12.6792C11.8576 12.4451 11.9039 12.2132 11.9937 11.997C12.0834 11.7807 12.2149 11.5843 12.3806 11.4189C12.5463 11.2534 12.743 11.1223 12.9594 11.0328C13.1758 10.9434 13.4077 10.8975 13.6418 10.8977H29.3081C29.5423 10.8975 29.7742 10.9434 29.9906 11.0328C30.207 11.1223 30.4036 11.2534 30.5693 11.4189C30.735 11.5843 30.8665 11.7807 30.9563 11.997C31.0461 12.2132 31.0924 12.4451 31.0925 12.6792Z"
                            fill="#E88CE2"
                          />
                          <path
                            d="M27.4873 19.0103C27.7283 19.0106 27.9653 19.072 28.1763 19.1885C28.3873 19.3051 28.5653 19.4731 28.694 19.6769C28.8226 19.8808 28.8976 20.1138 28.912 20.3544C28.9263 20.595 28.8797 20.8354 28.7763 21.0531C28.6728 21.2708 28.5161 21.4589 28.3205 21.5997C28.1249 21.7406 27.8969 21.8297 27.6576 21.8589C27.4183 21.888 27.1756 21.8561 26.9519 21.7662C26.7283 21.6764 26.531 21.5314 26.3784 21.3448C26.1918 21.5739 25.9389 21.7396 25.6544 21.8192C25.3699 21.8988 25.0677 21.8884 24.7893 21.7894C24.5109 21.6904 24.27 21.5077 24.0997 21.2663C23.9293 21.0249 23.8379 20.7367 23.8379 20.4412C23.8379 20.1458 23.9293 19.8575 24.0997 19.6162C24.27 19.3748 24.5109 19.192 24.7893 19.093C25.0677 18.994 25.3699 18.9836 25.6544 19.0632C25.9389 19.1428 26.1918 19.3085 26.3784 19.5376C26.5123 19.3726 26.6813 19.2397 26.8731 19.1484C27.065 19.0572 27.2748 19.01 27.4873 19.0103Z"
                            fill="#E88CE2"
                          />
                          <path
                            d="M28.1199 10.4017V10.8977H13.6423C13.4081 10.8975 13.1762 10.9434 12.9598 11.0328C12.7434 11.1223 12.5467 11.2534 12.381 11.4189C12.2153 11.5843 12.0838 11.7808 11.9941 11.997C11.9043 12.2133 11.858 12.4451 11.8579 12.6793V21.1024H10.6692C10.435 21.1026 10.2031 21.0567 9.98671 20.9673C9.77031 20.8778 9.57365 20.7467 9.40794 20.5812C9.24224 20.4158 9.11075 20.2193 9.02099 20.0031C8.93122 19.7868 8.88493 19.555 8.88477 19.3208V9.70617C8.88492 9.47202 8.93121 9.24019 9.02097 9.02392C9.11074 8.80766 9.24222 8.61119 9.40793 8.44575C9.57363 8.28031 9.7703 8.14913 9.9867 8.0597C10.2031 7.97027 10.435 7.92435 10.6692 7.92456H26.3355C26.5696 7.92435 26.8015 7.97027 27.018 8.0597C27.2344 8.14913 27.431 8.28031 27.5967 8.44575C27.7624 8.61119 27.8939 8.80766 27.9837 9.02392C28.0735 9.24019 28.1197 9.47202 28.1199 9.70617V10.4017Z"
                            fill="#EFAFEB"
                          />
                          <path
                            d="M27.4861 18.4631C27.0913 18.4626 26.7054 18.5807 26.3786 18.8022C26.0529 18.5805 25.6679 18.4623 25.2739 18.4631C24.9649 18.463 24.6602 18.5354 24.3842 18.6744C24.1082 18.8134 23.8687 19.0152 23.6848 19.2636C23.5009 19.512 23.3779 19.8 23.3255 20.1045C23.2731 20.4091 23.2929 20.7216 23.3832 21.0172C23.4735 21.3127 23.6318 21.5829 23.8455 21.8062C24.0592 22.0294 24.3222 22.1994 24.6135 22.3026C24.9048 22.4057 25.2162 22.4391 25.5227 22.4001C25.8293 22.3611 26.1224 22.2508 26.3786 22.078C26.6347 22.2509 26.9277 22.3613 27.2342 22.4005C27.5407 22.4396 27.8521 22.4063 28.1435 22.3034C28.4348 22.2004 28.6979 22.0305 28.9117 21.8074C29.1255 21.5843 29.284 21.3142 29.3745 21.0188C29.465 20.7234 29.485 20.4108 29.4329 20.1063C29.3808 19.8017 29.258 19.5136 29.0743 19.2651C28.8907 19.0166 28.6514 18.8146 28.3756 18.6753C28.0997 18.536 27.7951 18.4634 27.4861 18.4631H27.4861ZM27.4861 21.3222C27.3553 21.3238 27.2258 21.2961 27.1071 21.2412C26.9883 21.1863 26.8834 21.1056 26.7998 21.005C26.7481 20.9435 26.6834 20.8943 26.6103 20.861C26.5372 20.8277 26.4576 20.8111 26.3773 20.8124H26.3759C26.2953 20.8111 26.2155 20.828 26.1423 20.8617C26.0691 20.8954 26.0044 20.9451 25.953 21.0071C25.8709 21.1076 25.7673 21.1885 25.6498 21.2436C25.5324 21.2988 25.404 21.3269 25.2742 21.3259C25.0398 21.3259 24.8149 21.2327 24.6491 21.0669C24.4833 20.9012 24.3902 20.6763 24.3902 20.4418C24.3902 20.2074 24.4833 19.9825 24.6491 19.8167C24.8149 19.651 25.0398 19.5578 25.2742 19.5578C25.4041 19.5574 25.5325 19.5862 25.6497 19.6421C25.767 19.698 25.8701 19.7796 25.9515 19.8809C26.0026 19.9443 26.0673 19.9955 26.1407 20.0307C26.2142 20.066 26.2946 20.0844 26.376 20.0845C26.4575 20.0847 26.538 20.0667 26.6116 20.0318C26.6852 19.9969 26.7501 19.946 26.8015 19.8828C26.8955 19.7674 27.0172 19.6777 27.1552 19.622C27.2932 19.5663 27.4431 19.5464 27.5909 19.5642C27.7386 19.582 27.8795 19.6369 28.0003 19.7238C28.1212 19.8107 28.2181 19.9267 28.282 20.0612C28.3459 20.1956 28.3748 20.344 28.366 20.4925C28.3571 20.6411 28.3108 20.785 28.2313 20.9109C28.1519 21.0368 28.0419 21.1405 27.9116 21.2124C27.7813 21.2843 27.6349 21.3221 27.4861 21.3222Z"
                            fill="#CC00C1"
                          />
                          <path
                            d="M10.6689 21.6328H11.3047V22.2939C11.3064 22.9141 11.5529 23.5086 11.9906 23.948C12.4283 24.3875 13.0218 24.6364 13.642 24.6406H29.3083C29.9288 24.6365 30.5227 24.3877 30.9608 23.9483C31.399 23.5089 31.6461 22.9144 31.6484 22.2939V16.7258C31.6484 16.6766 31.6712 16.6243 31.6712 16.5701C31.6712 16.516 31.6484 16.4638 31.6484 16.4144V14.1604C31.6484 14.1111 31.6712 14.0588 31.6712 14.0047C31.6712 13.9505 31.6484 13.8984 31.6484 13.849V12.6792C31.6484 11.3953 30.5938 10.3672 29.3083 10.3672H28.6406V9.70613C28.6406 8.42223 27.6207 7.35938 26.3352 7.35938H10.6689C9.38341 7.35938 8.35157 8.42223 8.35157 9.70613V19.3208C8.35085 19.6251 8.41034 19.9265 8.52661 20.2077C8.64288 20.4889 8.81363 20.7443 9.02903 20.9592C9.24442 21.174 9.50021 21.3442 9.78165 21.4598C10.0631 21.5754 10.3646 21.6342 10.6689 21.6328ZM30.5547 16H12.3984V14.5781H30.5547V16ZM29.3083 23.5469H13.642C13.3117 23.543 12.9963 23.4094 12.7636 23.175C12.531 22.9406 12.3998 22.6241 12.3984 22.2939V17.0938H30.5547V22.2939C30.5527 22.6244 30.4209 22.941 30.1878 23.1753C29.9547 23.4097 29.6388 23.5431 29.3083 23.5469ZM30.5547 12.6792V13.4844H12.3984V12.6792C12.3998 12.5174 12.4331 12.3576 12.4964 12.2087C12.5597 12.0599 12.6517 11.925 12.7673 11.8118C12.8828 11.6987 13.0195 11.6094 13.1696 11.5492C13.3197 11.489 13.4803 11.459 13.642 11.4609H29.3083C29.9907 11.4609 30.5547 11.9984 30.5547 12.6792ZM9.44532 9.70613C9.44532 9.02527 9.98673 8.45312 10.6689 8.45312H26.3352C27.0176 8.45312 27.5469 9.02527 27.5469 9.70613V10.3672H13.642C12.3565 10.3672 11.3047 11.3953 11.3047 12.6792V20.5391H10.6689C10.5082 20.5406 10.3488 20.5103 10.2 20.4497C10.0512 20.3891 9.91594 20.2995 9.80207 20.1861C9.6882 20.0727 9.59802 19.9379 9.53678 19.7893C9.47553 19.6408 9.44444 19.4815 9.44532 19.3208V9.70613Z"
                            fill="#CC00C1"
                          />
                        </svg>
                        <div>
                          <p className="text-left text-base font-medium text-black">
                            One card saved
                          </p>
                          <p className="text-[13px] font-medium text-black">
                            Select from saved cards
                          </p>
                        </div>
                        <svg
                          width="32"
                          height="32"
                          viewBox="0 0 32 32"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <rect
                            x="32"
                            y="32"
                            width="32"
                            height="32"
                            rx="16"
                            transform="rotate(180 32 32)"
                            fill="#FAE5F9"
                          />
                          <path
                            d="M9 16.9999L19 16.9999L15.71 20.2899C15.6163 20.3829 15.5419 20.4935 15.4911 20.6154C15.4403 20.7372 15.4142 20.8679 15.4142 20.9999C15.4142 21.132 15.4403 21.2627 15.4911 21.3845C15.5419 21.5064 15.6163 21.617 15.71 21.7099C15.8974 21.8962 16.1508 22.0007 16.415 22.0007C16.6792 22.0007 16.9326 21.8962 17.12 21.7099L21.41 17.4099C21.7856 17.0366 21.9978 16.5295 22 15.9999C21.9951 15.4738 21.7832 14.9708 21.41 14.5999L17.12 10.3C17.0268 10.2074 16.9162 10.1341 16.7946 10.0842C16.6731 10.0344 16.5429 10.0089 16.4115 10.0094C16.2801 10.0099 16.1501 10.0362 16.0288 10.0869C15.9076 10.1376 15.7976 10.2117 15.705 10.305C15.6124 10.3982 15.5391 10.5088 15.4893 10.6303C15.4394 10.7519 15.414 10.8821 15.4144 11.0135C15.4149 11.1449 15.4412 11.2749 15.492 11.3961C15.5427 11.5173 15.6168 11.6274 15.71 11.72L19 14.9999L9 14.9999C8.73478 14.9999 8.48043 15.1053 8.29289 15.2928C8.10536 15.4804 8 15.7347 8 15.9999C8 16.2652 8.10536 16.5195 8.29289 16.7071C8.48043 16.8946 8.73478 16.9999 9 16.9999Z"
                            fill="#CC00C1"
                          />
                        </svg>
                      </button>
                    </form>

                    <Link href="/card-details">
                      <div className="mt-8 flex w-full items-center justify-between px-4">
                        <svg
                          width="40"
                          height="32"
                          viewBox="0 0 40 32"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <rect width="40" height="32" rx="4" fill="#FAE5F9" />
                          <g clip-path="url(#clip0_4494_61229)">
                            <path
                              d="M27 7H13C11.6744 7.00159 10.4036 7.52888 9.46622 8.46622C8.52888 9.40356 8.00159 10.6744 8 12H32C31.9984 10.6744 31.4711 9.40356 30.5338 8.46622C29.5964 7.52888 28.3256 7.00159 27 7Z"
                              fill="#CC00C1"
                            />
                            <path
                              d="M8 20C8.00159 21.3256 8.52888 22.5964 9.46622 23.5338C10.4036 24.4711 11.6744 24.9984 13 25H27C28.3256 24.9984 29.5964 24.4711 30.5338 23.5338C31.4711 22.5964 31.9984 21.3256 32 20V14H8V20ZM15 19.5C15 19.7967 14.912 20.0867 14.7472 20.3334C14.5824 20.58 14.3481 20.7723 14.074 20.8858C13.7999 20.9994 13.4983 21.0291 13.2074 20.9712C12.9164 20.9133 12.6491 20.7704 12.4393 20.5607C12.2296 20.3509 12.0867 20.0836 12.0288 19.7926C11.9709 19.5017 12.0006 19.2001 12.1142 18.926C12.2277 18.6519 12.42 18.4176 12.6666 18.2528C12.9133 18.088 13.2033 18 13.5 18C13.8978 18 14.2794 18.158 14.5607 18.4393C14.842 18.7206 15 19.1022 15 19.5Z"
                              fill="#CC00C1"
                            />
                          </g>
                          <defs>
                            <clipPath id="clip0_4494_61229">
                              <rect
                                width="24"
                                height="24"
                                fill="white"
                                transform="translate(8 4)"
                              />
                            </clipPath>
                          </defs>
                        </svg>

                        <div>
                          <p className="text-base font-medium text-black">Add a new debit card</p>
                          <p className="text-[13px] font-medium text-black">Pay with a new card</p>
                        </div>
                        <svg
                          width="32"
                          height="32"
                          viewBox="0 0 32 32"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <rect
                            x="32"
                            y="32"
                            width="32"
                            height="32"
                            rx="16"
                            transform="rotate(180 32 32)"
                            fill="#FAE5F9"
                          />
                          <path
                            d="M9 16.9999L19 16.9999L15.71 20.2899C15.6163 20.3829 15.5419 20.4935 15.4911 20.6154C15.4403 20.7372 15.4142 20.8679 15.4142 20.9999C15.4142 21.132 15.4403 21.2627 15.4911 21.3845C15.5419 21.5064 15.6163 21.617 15.71 21.7099C15.8974 21.8962 16.1508 22.0007 16.415 22.0007C16.6792 22.0007 16.9326 21.8962 17.12 21.7099L21.41 17.4099C21.7856 17.0366 21.9978 16.5295 22 15.9999C21.9951 15.4738 21.7832 14.9708 21.41 14.5999L17.12 10.3C17.0268 10.2074 16.9162 10.1341 16.7946 10.0842C16.6731 10.0344 16.5429 10.0089 16.4115 10.0094C16.2801 10.0099 16.1501 10.0362 16.0288 10.0869C15.9076 10.1376 15.7976 10.2117 15.705 10.305C15.6124 10.3982 15.5391 10.5088 15.4893 10.6303C15.4394 10.7519 15.414 10.8821 15.4144 11.0135C15.4149 11.1449 15.4412 11.2749 15.492 11.3961C15.5427 11.5173 15.6168 11.6274 15.71 11.72L19 14.9999L9 14.9999C8.73478 14.9999 8.48043 15.1053 8.29289 15.2928C8.10536 15.4804 8 15.7347 8 15.9999C8 16.2652 8.10536 16.5195 8.29289 16.7071C8.48043 16.8946 8.73478 16.9999 9 16.9999Z"
                            fill="#CC00C1"
                          />
                        </svg>
                      </div>
                    </Link>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </>
  )
}

export default SavedCards
